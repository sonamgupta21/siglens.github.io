<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SigLens | SigLens 1025x faster than Elasticsearch</title>
    <link rel="icon" href="../favicon.svg">

    <!-- Font Family -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,300;0,400;0,500;0,700;1,100&display=swap"
        rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@1,500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../css/bootstrap.css">
    <!--  Main CSS File -->
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="blog.css">

    <!-- Font-awesome Family -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
        integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />

    <!-- Include Prism.js CSS -->
    <link rel="stylesheet" href="./dark-theme-prismjs.css">

    <link rel="canonical" href="https://www.siglens.com/blog/siglens-1025x-faster-than-elasticsearch.html">
    <!--OG Tags-->
    <meta property="og:url" content="https://www.siglens.com/blog/siglens-1025x-faster-than-elasticsearch.html" />
    <meta property="og:title" content="SigLens 1025x faster than Elasticsearch" />
    <meta property="og:description" content="SigLens - 1025x faster than Elasticsearch. Reduce your observability costs by 90%" />
    <meta property="og:type" content="article">
    <meta property="og:image" content="https://www.siglens.com/assets/siglens-1025x-faster-than-elasticsearch.png" />
    <meta property="og:image:secure_url"
        content="https://www.siglens.com/assets/siglens-1025x-faster-than-elasticsearch.png" />
    <meta property="og:image:type" content="image/jpg" />
    <meta name="image" property="og:image"
        content="https://www.siglens.com/assets/siglens-1025x-faster-than-elasticsearch.png">
    <meta property="og:image:width" content="1920">
    <meta property="og:image:height" content="1080">

    <!--Twitter OG Tag-->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@siglens.com" />
    <meta name="twitter:image" content="https://www.siglens.com/assets/siglens-1025x-faster-than-elasticsearch.png">
    </meta>
    <meta name="twitter:image:alt" content="SigLens 1025x faster than Elasticsearch" />
    <style>
        .sub-heading {
            margin-top: 24px !important;
            margin-bottom: 12px !important;
        }
        .yellow{
            color: #DDDE54 !important;
        }

        #try-siglens-btn {
            margin-top: 20px;
            background: linear-gradient(270deg, #11beb0, #49d880);
            width: fit-content;
            padding: 10px 20px;
            border-radius: 10px;
            color: var(--white-0);
            font-weight: 500;
            box-shadow: 0px 1px 4px 2px rgba(165, 149, 233, 0.2);
        }
        #github-siglens-btn {
            margin-top: 20px;
            background: linear-gradient(270deg, #161828, #333B64);
            width: fit-content;
            padding: 10px 20px;
            border-radius: 10px;
            color: var(--white-0);
            font-weight: 500;
            box-shadow: 0px 1px 4px 2px rgba(165, 149, 233, 0.2);
        }
        #try-siglens-btn:hover,  #github-siglens-btn:hover{
            cursor: pointer;
            transform: translateY(-3px) scale(1.005) translateZ(0);
            box-shadow: 0px 4px 9px 2px rgba(46, 32, 95, 0.25);
            transition: all 0.3s ease-out;
        }
        #github-siglens-btn .fa-github{
                font-size: 20px !important;
        }

        #section8 .blog-para {
            font-size: 10px;
            line-height: 20px;
        }

        #section8 .heading {
            font-size: 10px;
        }

        @media (max-width: 767.98px) {
            #github-siglens-btn,#try-siglens-btn {
                padding: 6px 14px;
                font-size: 16px;
            }
            #github-siglens-btn .fa-github{
                font-size: 16px !important;
            }
        }
    </style>
</head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-RGR7MCHV8F"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'G-RGR7MCHV8F');
</script>

<body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg fixed-top py-2 px-4 px-md-0">
        <div class="container">
            <a class="navbar-brand " href="../index.html">
                <div class="d-flex">
                    <div class="pr-1"><img src="../assets/ss-logo.svg" alt=""></div>
                    <div class="font-weight-bold text-white h2 pl-1">SigLens</div>
                </div>
            </a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
                aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav ml-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="https://siglens.github.io/siglens-docs/"
                            target="_blank">Documentation</a>
                    </li>
                    <li class="nav-item active">
                        <a class="nav-link" href="/blog/allblogs.html">Blogs</a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="about-us.html" id="navbarDropdown" role="button"
                            data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> Community </a>
                        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                            <a class="dropdown-item" href="https://github.com/siglens/siglens">GitHub</a>
                            <a class="dropdown-item" href="/slack.html">Slack</a>
                            <a class="dropdown-item" href="../guides.html">Guides</a>
                            <a class="dropdown-item" href="../questions.html">Questions</a>
                        </div>
                    </li>
                    <li>
                        <a href="../index.html#getting-started" id="try-now-btn">Try Now</a>
                    </li>
                    <li>
                        <a href="https://github.com/siglens/siglens" target="_blank">
                            <img src="../assets/github.svg" width="26" height="26" alt="" />
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container my-md-5 pt-5 my-2 blog-post">


        <div class="container-md">
            <img class="mt-3 ss-vs-ch" src="../assets/siglens-vs-elasticsearch.png"/>
            <div class="d-flex">
                <div id="sidebar">
                    <nav id="sidebar-nav">
                        <ul class="nav flex-column">
                            <li class="nav-item main-link"><a class="section-nav-link" href="#section0">
                                    <h5>Article Navigator</h5>
                                </a></li>
                            <li class="nav-item main-link"><a class="section-nav-link" href="#section1">Overview of the
                                    test, dataset
                                </a></li>
                            <li class="nav-item main-link"><a class="section-nav-link" href="#section2">Introductions of the databases</a>
                            </li>
                            <ul class="sub-navbar flex-column">
                                <li class="nav-item"><a class="section-nav-link" href="#section2-1">
                                    Elasticsearch</a></li>
                                    <li class="nav-item"><a class="section-nav-link" href="#section2-2">
                                        SigLens</a></li>
                            </ul>
                            <li class="nav-item main-link"><a class="section-nav-link" href="#section3">Test
                                    Setup</a></li>
                            <ul class="sub-navbar flex-column">
                                <li class="nav-item"><a class="section-nav-link" href="#section3-1">Common steps for
                                        both</a></li>
                                <li class="nav-item"><a class="section-nav-link" href="#section3-2">Cleanup and
                                        Prepare Dataset
                                    </a></li>
                            </ul>
                            <li class="nav-item main-link"><a class="section-nav-link" href="#section4">Benchmark
                                    Elasticsearch</a></li>
                            <ul class="sub-navbar flex-column">
                                <li class="nav-item"><a class="section-nav-link" href="#section4-1">Download
                                        Elasticsearch</a></li>
                                <li class="nav-item"><a class="section-nav-link" href="#section4-2">Configure Elasticsearch</a></li>
                                <li class="nav-item"><a class="section-nav-link" href="#section4-3">Add a template</a></li>
                                <li class="nav-item"><a class="section-nav-link" href="#section4-4">Save the password for later</a></li>
                                <li class="nav-item"><a class="section-nav-link" href="#section4-5">Run Elasticsearch</a></li>
                                <li class="nav-item"><a class="section-nav-link" href="#section4-6">Ingest the Data</a></li>
                                <li class="nav-item"><a class="section-nav-link" href="#section4-7">Run the Queries in Elasticsearch</a></li>
                                <li class="nav-item"><a class="section-nav-link" href="#section4-8">Elasticsearch Query
                                        Results</a></li>
                            </ul>
                            <li class="nav-item main-link"><a class="section-nav-link" href="#section5">Benchmark
                                    SigLens</a></li>
                            <ul class="sub-navbar flex-column">
                                <li class="nav-item"><a class="section-nav-link" href="#section5-1">Install Go and
                                        SigLens</a></li>
                                <li class="nav-item"><a class="section-nav-link" href="#section5-2">Prepare Agile
                                        Aggregations</a></li>
                                <li class="nav-item"><a class="section-nav-link" href="#section5-3">Ingest data into
                                        SigLens</a></li>
                                <li class="nav-item"><a class="section-nav-link" href="#section5-4">Run Queries
                                        against SigLens</a></li>
                                <li class="nav-item"><a class="section-nav-link" href="#section5-5">SigLens Query Results:</a></li>
                            </ul>
                            <li class="nav-item main-link"><a class="section-nav-link" href="#section6">Result
                                    Comparison
                                </a>
                            </li>
                            <li class="nav-item main-link"><a class="section-nav-link" href="#section7  ">
                                Try SigLens in less than 1 minute
                                </a>
                            </li>
                            <li class="nav-item main-link"><a class="section-nav-link" href="#section8">Benchmark
                                    Questions?</a></li>
                        </ul>
                    </nav>
                </div>
                <div id="all-sections" class="container-md">
                    <div id="section0" class="d-flex flex-column align-items-center">
                        <div class="para-bold mb-2 mt-4">
                            SigLens beats Elasticsearch
                            by an astounding <strong style="font-size: 20px;">1025x</strong> in the NYC Taxi Dataset
                            performance test. This test resulted in processing 1 billion records and SigLens performed
                            magnitudes faster than Elasticsearch.
                        </div>
                        <div class="para-bold mb-3">
                            In this blog, we outlined the detailed steps of this benchmark. You will learn ingestion and querying of a massive dataset along with tuning systems settings. Let’s explore it.
                        </div>
                    </div>
                    <div id="section1" class="section">
                        <div>
                            <h1 class="heading">Overview of the test, dataset
                            </h1>
                            <div>
                                <div class="blog-para">
                                    <p class="mt-2">The objective of this benchmark is to assess performance of these two databases under conditions mirroring real world scenarios. Our approach involves running both databases on identical hardware configurations, ingesting identical dataset and running the same set of queries. For this reason we opted for the NYC Taxi Dataset.
                                    </p>
                                    <p>
                                        The NYC Taxi Dataset is a massive dataset of over 1 Billion trips made by NYC Taxis and Uber, all originating in New York City since 2009.
                                    </p>
                                    <p class="mt-2 mb-2">
                                        The queries used were as follows:
                                    </p>
                                    <ul>
                                        <li>Q1: Find the total number of rides.<span class="foot-note"></span>
                                        </li>
                                        <li>Q2: Find the average ride cost grouped by the number of passengers.
                                        </li>
                                        <li>Q3: Find the number of rides grouped by the number of passengers and the
                                            pick-up location.</li>
                                        <li>Q4: Find the number of rides grouped by the number of passengers, pick-up
                                            location, and trip distance.
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div>
                        <h2 class="heading mt-2 section" id="section2"> Introductions of the databases
                        </h2>
                        <div>
                        <h2 class="sub-heading mt-2 section" id="section2-1"> Elasticsearch:
                        </h2>
                        <div class="mt-2">Elasticsearch is a distributed, open-source search and analytics engine. It offers a schema-free JSON document store for diverse data types. It supports complex queries and aggregations. Widely used for log and event data analysis by observability companies. It offers powerful full-text search capabilities and integrates with various data sources. 
                        </div>
                    </div>
                    </div>
                    <div>
                        <h2 class="sub-heading mt-2 section" id="section2-2"> SigLens:
                        </h2>
                        <p class="mt-2">SigLens is a column oriented database built from scratch for observability
                            data. It
                            offers dynamic compressions over each column requiring zero configuration.
                        </p>
                        <p>SigLens uses
                            columnar micro indices that are 1/100th size of an actual database index.
                            This reduces the number of machines needed. SigLens uses AgileAggregationTree algorithm
                            that makes aggregations queries run at sub-second speeds. </p>
                    </div>
                    <div id="section3" class="section mt-4">
                        <div>
                            <h1 class="heading">Test Setup
                            </h1>
                            <div>
                                <div class="blog-para mt-2">
                                    We used an AWS <span class="courier-font">im4gn.2xlarge</span> instance for both
                                    SigLens and ClickHouse, it had the following hardware configuration:
                                    <ul>
                                        <li>8 vCPUs</li>
                                        <li>32 GB of RAM</li>
                                        <li>3.5 TB of storage</li>
                                        <li>10 Gigabit networking</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div>
                            <h2 class="sub-heading mt-2 section" id="section3-1"> Common steps for both:
                            </h2>
                            <p class="blog-para mt-2">Setup the server, mount the storage, configure aws s3 cli by
                                following these steps:
                            </p>

                            <p><b>Step 1:</b> Let’s find out if the NVM storage device is present on this server. To
                                find that, ssh into your server and run <span class="courier-font">lsblk</span>.
                                You
                                should see something like the following, with the <span
                                    class="courier-font">nvme1n1</span> item having 3.4 TB of storage.</p>
                            <div class="position-relative">
                                <pre><code class="language-javascript">NAME         MAJ:MIN RM   SIZE RO TYPE MOUNTPOINTS
loop0          7:0    0  21.3M  1 loop /snap/amazon-ssm-agent/7529
loop1          7:1    0  49.1M  1 loop /snap/core18/2794
loop2          7:2    0  59.3M  1 loop /snap/core20/2019
loop3          7:3    0 109.6M  1 loop /snap/lxd/24326
loop4          7:4    0  35.5M  1 loop /snap/snapd/20102
nvme0n1      259:0    0     8G  0 disk
├─nvme0n1p1  259:2    0   7.9G  0 part /
└─nvme0n1p15 259:3    0    99M  0 part /boot/efi
nvme1n1      259:1    0   3.4T  0 disk</code></pre>
                            </div>
                            <p class="mt-4"><b>Step 2:</b> Let’s mount the storage device and create directories.</p>
                            <pre class="language-javascript"><code class="language-javascript">sudo mkfs.xfs /dev/nvme1n1
sudo mkdir /mnt/nvme1n1
sudo mount /dev/nvme1n1 /mnt/nvme1n1</code></pre>
                            <p class="mt-4"><b>Step 3:</b> Verify Storage
                            </p>
                            <p> You can check that it's mounted by running <span class="courier-font">df -h</span>
                                and
                                you should see something like this:</p>
                            <pre data-line="1-3"><code class="language-javascript">Filesystem       Size  Used Avail Use% Mounted on
/dev/root        7.6G  1.5G  6.2G  20% /
tmpfs             16G     0   16G   0% /dev/shm
tmpfs            6.2G  948K  6.2G   1% /run
tmpfs            5.0M     0  5.0M   0% /run/lock
/dev/nvme0n1p15   98M  6.3M   92M   7% /boot/efi
tmpfs            3.1G  4.0K  3.1G   1% /run/user/1000
/dev/nvme1n1     3.5T   25G  3.4T   1% /mnt/nvme1n1</code></pre>
                            <p class="mt-4"><b>Step 4:</b> Update Permissions
                            </p>
                            <pre
                                class="language-javascript"><code class="language-javascript">sudo chmod 777 /mnt/nvme1n1</code></pre>
                            <p class="mt-4"><b>Step 5:</b> Configure AWS CLI
                                <br>
                            <p class="courier-font note"><b>Note:</b> This AWS config step is only needed if you are
                                using a
                                private
                                S3 bucket, if you use our public S3 bucket you can skip this step.</p>
                            </p>
                            <pre class="language-javascript"><code class="language-javascript">sudo apt-get install awscli -y
aws configure</code></pre>
                        </div>
                        <div>
                            <h2 class="sub-heading mt-2 section" id="section3-2"> Cleanup and Prepare Dataset:
                            </h2>
                            <p class="mt-2 courier-font note"><b>Note:</b> You can skip this step and use our s3
                                bucket. It
                                has
                                the dataset in the correct format. If you want to prepare the dataset yourself then
                                follow these steps else jump directly to the benchmark step to use our s3 bucket.
                            </p>
                            <pre class="language-javascript"><code class="language-javascript">mkdir -p /mnt/nvme1n1/data
cd /mnt/nvme1n1/data</code></pre>
                            <div class="my-3">
                                Download the dataset from <a
                                    href="https://www.nyc.gov/site/tlc/about/tlc-trip-record-data.page">https://www.nyc.gov/site/tlc/about/tlc-trip-record-data.page</a>
                                into above dir. We used the 2011-2017 yellow taxi trip parquet files
                            </div>

                            <div class="my-3">Next, you need to convert the parquet files to TSV.</div>

                            <pre class="language-javascript"><code class="language-javascript">git clone git@github.com:siglens/siglens
python -m venv taxis
source taxis/bin/activate
pip install -r siglens/tools/nyc-taxi-benchmark/requirements.txt
python siglens/tools/nyc-taxi-benchmark/parquet_to_tsv.py . .</code></pre>
                            <div class="my-3">
                                The above cmd takes two parameters: input_dir , output_dir. It will read *.parquet
                                files
                                from the input_dir and convert them to tsv files and put them in output_dir.
                            </div>
                            <div class="my-3">
                                Elasticsearch and SigLens both will use JSON. Let’s convert the
                                tsv
                                files to json now. Put the below content in some bash file and run it or run the
                                below
                                commands in a terminal.
                            </div>
                            <pre class="language-javascript"><code class="language-javascript">for year in {2011..2017}; do
    for month in {01..12}; do
        basefile="yellow_tripdata_$year-$month"
        go run siglens/tools/sigclient/cmd/utils/converter.go --input 
"$basefile.tsv" --output "$basefile.json" &
    done
done
wait</code></pre>
                            <div class="my-3">
                                Finally, compress the TSV and JSON files with gzip and upload them to your AWS S3
                                bucket. We ingested the TSV and JSON files into separate directories to make it
                                easier to
                                download all of one type.
                            </div>
                        </div>
                    </div>
                    <div id="section4" class="section">
                        <div>
                            <h1 class="heading">Benchmark Elasticsearch
                            </h1>
                        </div>
                        <div class="blog-para">
                            You'll want two terminals in your Elasticsearch server; the first will run Elasticsearch and the second will ingest data. Start with Terminal 1.
                        </div>
                        <div>
                            <h2 class="sub-heading mt-2 section" id="section4-1">Download Elasticsearch
                            </h2>
                            <pre class="language-javascript"><code class="language-javascript">cd /mnt/nvme1n1
wget https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-8.11.4-linux-aarch64.tar.gz
wget https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-8.11.4-linux-aarch64.tar.gz.sha512
shasum -a 512 -c elasticsearch-8.11.4-linux-aarch64.tar.gz.sha512</code></pre>
                            <div class="blog-para mt-4">This should output <span class="courier-font">elasticsearch-8.11.4-linux-aarch64.tar.gz: OK</span>.</div>
                            <pre class="language-javascript"><code class="language-javascript">tar -xzf elasticsearch-8.11.4-linux-aarch64.tar.gz
cd elasticsearch-8.11.4/</code></pre>
                        </div>
                        <div>
                            <h2 class="sub-heading mt-2 section" id="section4-2">Configure Elasticsearch
                            </h2>
                            <div class="blog-para">
                                Let’s bind to all ports and run elasticsearch in a single node configuration.</div>
                            <div class="blog-para mt-2">
                                Add the following to <span class="courier-font">config/elasticsearch.yml:</span>
                                <pre class="language-javascript"><code class="language-javascript">network.host: 0.0.0.0
discovery.type: single-node</code></pre>
                            </div>
                            <div class="blog-para mt-2">
                                Also delete the line <span class="courier-font">cluster.initial_master_nodes: ["ip-172-31-24-1"]</span> from that file. <p>Let’s give more memory to the elasticsearch process.</p>
                                <pre class="language-javascript"><code class="language-javascript">echo -e "-Xms24g\n-Xmx24g" > config/jvm.options.d/heap.options</code></pre>
                            </div>
                            <div class="blog-para mt-2">
                                Elasticsearch uses mmapfs for storing indices. Let’s increase this setting to a larger number for this test. 
                                <pre class="language-javascript"><code class="language-javascript">sudo sysctl -w vm.max_map_count=262144</code></pre>
                            </div>
                        </div>
                        <div>
                            <h2 class="sub-heading mt-2 section" id="section4-3">Add a template
                            </h2>
                            <div class="blog-para mt-2">
                                We will use 6 shards so that we get better write and read performance. We will also disable replication to increase performance. Additionally let’s setup the timestamp field.
                                <pre class="language-javascript"><code class="language-javascript">curl -k -u "elastic:" \
    --location \
    --request PUT 'https://<your_elasticsearch_host>:9200/_template/temp1' \
    --header 'Content-Type: application/json' \
    --data-raw '{
        "index_patterns": "trips",
        "settings": {
            "number_of_shards": 6,
            "number_of_replicas": 0
        },
        "mappings": {
            "_source": {
                "enabled": true
            },
            "properties": {
                "timestamp": {
                    "type": "date",
                    "format": "epoch_millis"
                }
            }
        }
    }'</code></pre>
                            </div>
                        </div>
                        <div>
                            <h2 class="sub-heading mt-2 section" id="section4-4">Save the password for later
                            </h2>
                            If you don't know the password for the elastic user, reset it with
                            <pre
                                class="language-javascript"><code class="language-javascript">bin/elasticsearch-reset-password -u elastic</code></pre>The new password will be printed. Save it for later.
                        </div>
                        <div>
                            <h2 class="sub-heading mt-2 section" id="section4-5">Run Elasticsearch
                            </h2>
                            <pre
                                class="language-javascript"><code class="language-javascript">./bin/elasticsearch > elastic.log 2>&1</code></pre>
                        </div>
                        <div>
                            <h2 class="sub-heading mt-2 section" id="section4-6">Ingest the Data</h2>In Terminal 2, clone siglens to use an ingester script from it.
                            <pre
                                class="language-javascript"><code class="language-javascript">cd /mnt nvme1n1
git clone https://github.com/siglens/siglens.git
cd siglens/tools/nyc-taxi-benchmark</code></pre>
                                    In ingester.py, make these changes:
                            <ul>
                                <li>Change <span class="courier-font">index_data = '{"index": {"_index": "trips", "_type": "_doc"}}'</span> to <span class="courier-font">index_data = '{"index": {"_index": "trips"}}'</span></li>
                                <li>In the curl section, add the <span class="courier-font">"-k"</span>, option, which allows faking SSL checks</li>
                                <li>In the curl section, add <span class="courier-font">"-u", "elastic:&lt;your-elastic-password&gt;"</span></li>
                                <li>In the curl section, change <span class="courier-font">"http://localhost:8081/elastic/_bulk", to "https://localhost:9200/elastic/_bulk"</span></li>
                            </ul>
                            Now download and ingest the data:
                            <pre class="language-javascript"><code class="language-javascript">mkdir dataset

for year in {2011..2017}; do
    for month in {01..12}; do
        {
            basefile="yellow_tripdata_$year-$month"
            aws s3 cp s3://siglens-benchmark-datasets/nyc-taxi-benchmark-data/json/$basefile.json.gz dataset/
            gunzip dataset/$basefile.json.gz
            python3 ingester.py dataset/$basefile.json
        } &
    done
    wait
done</code></pre>
                        </div>
                        <div>
                            <h2 class="sub-heading mt-2 section" id="section4-7">Run the Queries in Elasticsearch
                            </h2>To get benchmark results, we had to clear the Elasticsearch cache after every query. Otherwise, if we ran a query multiple times then the first time would take a while but every subsequent invocation would return much faster than the original search because it was returning the cached response. To clear the cache, run:
                            <pre class="language-javascript"><code class="language-javascript">curl -k -u "elastic:&lt;your-elastic-password&gt;"-X POST "https://&lt;server-ip&gt;:9200/trips/_cache/clear"</code></pre>
                              The following should indicate 265 unique values.
                              <pre class="language-javascript"><code class="language-javascript">curl -k -u "elastic:&lt;your-elastic-password&gt;" "https://&lt;server-ip&gt;:9200/trips/_search" 
    -H 'Content-Type: application/json'
    -d '{
        "size": 0,
        "aggs": {
            "distinct_PULocationID": {
                "cardinality": {
                    "field": "PULocationID"
                }
            }
        }
    }' | python3 -m json.tool
                              </code></pre>Now let’s run the actual queries.
                              <p>The responses will have a took field, indicating how long the query took in milliseconds.</p>
                              <pre class="language-javascript"><code class="language-javascript"># Query 1
curl -k -u "elastic:&lt;your-elastic-password&gt;" "https://&lt;server-ip&gt;:9200/trips/_search" 
    -H 'Content-Type: application/json' 
    -d '{
        "size": 0,
        "aggs": {
            "improvement_surcharge_groups": {
                "terms": {
                    "field": "improvement_surcharge",
                    "size": 10
                },
                "aggs": {
                    "count": {
                        "value_count": {
                            "field": "improvement_surcharge"
                        }
                    }
                }
            }
        }
    }' | python3 -m json.tool | less
                               
# Query 2
curl -k -u "elastic:&lt;your-elastic-password&gt;" "https://&lt;server-ip&gt;:9200/trips/_search" 
    -H 'Content-Type: application/json' 
    -d '{
        "size": 0,
        "aggs": {
            "passenger_count_groups": {
                "terms": {
                    "field": "passenger_count",
                    "size": 36
            },
            "aggs": {
                "average_total_amount": {
                    "avg": {
                        "field": "total_amount"
                    }
                }
            }
        }
    }
}' | python3 -m json.tool | less
                                
# Query 3
curl -k -u "elastic:&lt;your-elastic-password&gt;" "https://&lt;server-ip&gt;:9200/trips/_search" 
    -H 'Content-Type: application/json' 
    -d '{
        "size": 0,
        "aggs": {
            "passenger_count_groups": {
                "terms": {
                    "field": "passenger_count",
                    "size": 36
                },
                "aggs": {
                    "PULocationID_groups": {
                        "terms": {
                            "field": "PULocationID",
                            "size": 265
                        }
                    }
                }
            }
        }
    }' | python3 -m json.tool | less
                                
# Query 4
# For this query we don't want more than 10,000 buckets, so we'll reduce the "size" parameters.
curl -k -u "elastic:&lt;your-elastic-password&gt;" "https://&lt;server-ip&gt;:9200/trips/_search" 
    -H 'Content-Type: application/json' 
    -d '{
        "size": 0,
        "aggs": {
            "passenger_count_groups": {
                "terms": {
                    "field": "passenger_count",
                    "size": 10
                },
            "aggs": {
                "PULocationID_groups": {
                    "terms": {
                        "field": "PULocationID",
                        "size": 10
                    },
                    "aggs": {
                        "trip_distance_groups": {
                            "terms": {
                                "field": "trip_distance",
                                "size": 100
                            },
                            "aggs": {
                                "count": {
                                    "value_count": {
                                        "field":
                                        "trip_distance"
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
    }' | python3 -m json.tool | less</code></pre>
                        </div>
                        <div>
                            <h2 class="sub-heading mt-2 section" id="section4-8">Elasticsearch Query Results
                            </h2>
                            We ran each query for 5 times, and took the lowest number from those runs.
                            <div class="my-4 table-div">
                                <table class="ShapeDataTable query-result-table">
                                    <tr>
                                        <td></td>
                                        <td class="yellow">Try 1</td>
                                        <td class="yellow">Try 2</td>
                                        <td class="yellow">Try 3</td>
                                        <td class="yellow">Try 4</td>
                                        <td class="yellow">Try 5</td>
                                        <td class="yellow"><b>Lowest</b></td>
                                    </tr>
                                    <tr>
                                        <td class="yellow"><b>Q1</b></td>
                                        <td>27,780 ms</td>
                                        <td>27,559 ms</td>
                                        <td>27,575 ms</td>
                                        <td>27,646 ms</td>
                                        <td>27,588 ms</td>
                                        <td><b>27,559 ms</b></td>
                                    </tr>
                                    <tr>
                                        <td class="yellow"><b>Q2</b></td>
                                        <td>48,278 ms</td>
                                        <td>49,253 ms</td>
                                        <td>47,315 ms</td>
                                        <td>46,925 ms</td>
                                        <td>44,075 ms</td>
                                        <td><b>44,075 ms</b></td>
                                    </tr>
                                    <tr>
                                        <td class="yellow"><b>Q3</b></td>
                                        <td>50,417  ms</td>
                                        <td>50,274 ms</td>
                                        <td>50,110 ms</td>
                                        <td>50,380 ms</td>
                                        <td>50,522 ms</td>
                                        <td><b>50,110 ms</b></td>
                                    </tr>
                                    <tr>
                                        <td class="yellow"><b>Q4</b></td>
                                        <td>1,26,616 ms</td>
                                        <td>1,26,728 ms</td>
                                        <td>1,25,167 ms</td>
                                        <td>1,27,522 ms</td>
                                        <td>1,26,263 ms</td>
                                        <td><b>1,25,167 ms</b></td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div id="section5" class="section">
                        <div>
                            <h1 class="heading">Benchmark SigLens
                            </h1>
                            <div>
                                <div class="blog-para mt-3">
                                    You'll want three terminals. Terminal 1 will run SigLens, Terminal 2 will do
                                    some
                                    setup and view the logs, and Terminal 3 will send the queries. Terminal 3 can
                                    run on
                                    your local machine if you set up the server to accept HTTP traffic, but
                                    Terminals 1
                                    and 2 should be on the server. Start with Terminal 1.
                                </div>
                            </div>
                        </div>
                        <div>
                            <h2 class="sub-heading mt-2 section" id="section5-1">Install Go and SigLens
                            </h2>
                            <div>
                                SigLens is built in golang. In this step we will install the go dependencies, install
                                SigLens and start it.
                            </div>
                            <pre class="language-javascript"><code class="language-javascript">sudo apt update
sudo apt install golang -y
git clone https://github.com/siglens/siglens.git
cd siglens

## Start SigLens
sudo go run cmd/siglens/main.go --config server.yaml</code></pre>
                            <div>
                                Wait until SigLens is running. You'll see these lines in the terminal once it's up:
                            </div>
                            <pre class="language-javascript"><code class="language-javascript">INFO[2023-12-06 18:10:38] Extracting config from configFile: server.yaml
INFO[2023-12-06 18:10:38] Defaulting to 2160hrs (90 days) of retention...
INFO[2023-12-06 18:10:38] ----- Siglens server type SingleNode starting up -----
INFO[2023-12-06 18:10:38] ----- Siglens Ingestion server starting on 0.0.0.0:8081 -----
INFO[2023-12-06 18:10:38] ----- Siglens Query server starting on 0.0.0.0:5122 -----
INFO[2023-12-06 18:10:38] ----- Siglens UI starting on 0.0.0.0:5122 -----</code></pre>
                        </div>
                        <div>
                            <h2 class="sub-heading mt-2 section" id="section5-2">Prepare Agile Aggregations
                            </h2>
                            In a continuous running ingest, you don’t need to do this step. However, since this is a
                            static dataset ingestion, we need to set up the aggregations columns. SigLens creates
                            aggregation trees during ingestion using these columns. These trees are used during query
                            processing
                            <div class="blog-para mb-3 mt-3">
                                Switch to Terminal 2 and run the following:
                            </div>
                            <pre class="language-javascript"><code class="language-javascript">curl -X POST -d '{
    "tableName": "trips",
    "groupByColumns": ["airport_fee", "passenger_count", "PULocationID", "trip_distance"],
    "measureColumns": ["total_amount"]
}' http://localhost:5122/api/pqs/aggs
echo ""</code></pre>
                            <div class="blog-para my-3">
                                You should get this response:
                            </div>
                            <pre
                                class="language-javascript"><code class="language-javascript">{"message":"All OK","status":200}</code></pre>
                        </div>
                        <div>
                            <h2 class="sub-heading mt-2 section" id="section5-3">Ingest data into SigLens
                            </h2>
                            <div class="blog-para mb-3">
                                Now let's ingest some data into SigLens. In Terminal 2 run
                            </div>
                            <pre class="language-javascript"><code class="language-javascript">cd /mnt/nvme1n1/siglens/tools/sigclient 
mkdir dataset</code></pre>
                            <div class="blog-para my-3">
                                Run the following script to download, decompress, and ingest the data into SigLens.
                            </div>
                            <pre class="language-javascript"><code class="language-javascript">for year in {2011..2017}; do
    for month in {01..12}; do
        {
            basefile="yellow_tripdata_$year-$month"
            aws s3 cp s3://siglens-benchmark-datasets/nyc-taxi-benchmark-data/json/$basefile.json.gz dataset/
            gunzip dataset/$basefile.json.gz
            python3 ../nyc-taxi-benchmark/ingester.py dataset/$basefile.json
        } &
    done
    wait
done</code></pre>
                        </div>
                        <div>
                            <h2 class="sub-heading mt-2 section" id="section5-4">Run Queries against SigLens
                            </h2>
                            <div class="blog-para mb-3">
                                Run the following in Terminal 3. If Terminal 3 is on your local machine, make sure
                                to
                                replace <span class="courier-font">localhost</span> with the IP of the server. You
                                can
                                remove the <span class="courier-font">| python3 -m json.tool</span> if you want, it
                                just
                                formats the JSON response. Check the log file <span
                                    class="courier-font">siglens.log</span> for the query times.
                            </div>
                            <pre class="language-javascript"><code class="language-javascript">curl -X POST -d '{
    "searchText": "SELECT airport_fee, count(*) FROM trips GROUP BY airport_fee",
    "indexName": "trips",
    "startEpoch": "now-24h",
    "endEpoch": "now",
    "queryLanguage": "SQL"
}' http://localhost:5122/api/search | python3 -m json.tool

curl -X POST -d '{
    "searchText": "SELECT passenger_count, avg(total_amount) FROM trips GROUP BY passenger_count",
    "indexName": "trips",
    "startEpoch": "now-24h",
    "endEpoch": "now",
    "queryLanguage": "SQL"
}' http://localhost:5122/api/search | python3 -m json.tool

curl -X POST -d '{
    "searchText": "SELECT passenger_count, PULocationID, count(*) FROM trips GROUP BY passenger_count, PULocationID",
    "indexName": "trips",
    "startEpoch": "now-24h",
    "endEpoch": "now",
    "queryLanguage": "SQL"
}' http://localhost:5122/api/search | python3 -m json.tool

curl -X POST -d '{
    "searchText": "SELECT passenger_count, PULocationID, trip_distance, count(*) FROM trips GROUP BY passenger_count, PULocationID, trip_distance",
    "indexName": "trips",
    "startEpoch": "now-24h",
    "endEpoch": "now",
    "queryLanguage": "SQL"
}' http://localhost:5122/api/search | python3 -m json.tool</code></pre>
                        </div>
                        <div>
                            <h2 class="sub-heading mt-2 section" id="section5-5">SigLens Query Results:
                            </h2>
                            <div>We ran each query for 5 times, and took the lowest number from those runs.
                            </div>
                            <div class="my-4 table-div">
                                <table class="ShapeDataTable query-result-table">
                                    <tr>
                                        <td></td>
                                        <td class="yellow">Try 1</td>
                                        <td class="yellow">Try 2</td>
                                        <td class="yellow">Try 3</td>
                                        <td class="yellow">Try 4</td>
                                        <td class="yellow">Try 5</td>
                                        <td class="yellow"><b>Lowest</b></td>
                                    </tr>
                                    <tr>
                                        <td class="yellow"><b>Q1</b></td>
                                        <td>60 ms</td>
                                        <td>72 ms</td>
                                        <td>63 ms</td>
                                        <td>41 ms</td>
                                        <td>42 ms</td>
                                        <td><b>41 ms</b></td>
                                    </tr>
                                    <tr>
                                        <td class="yellow"><b>Q2</b></td>
                                        <td>43 ms</td>
                                        <td>43 ms</td>
                                        <td>44 ms</td>
                                        <td>43 ms</td>
                                        <td>43 ms</td>
                                        <td><b>43 ms</b></td>
                                    </tr>
                                    <tr>
                                        <td class="yellow"><b>Q3</b></td>
                                        <td>116 ms</td>
                                        <td>304 ms</td>
                                        <td>442 ms</td>
                                        <td>509 ms</td>
                                        <td>471 ms</td>
                                        <td><b>116 ms</b></td>
                                    </tr>
                                    <tr>
                                        <td class="yellow"><b>Q4</b></td>
                                        <td>9,815 ms</td>
                                        <td>9,229 ms</td>
                                        <td>10,316 ms</td>
                                        <td>9,093 ms</td>
                                        <td>9,092 ms</td>
                                        <td><b>9,092 ms</b></td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                    </div>

                    <div id="section6" class="section">
                        <div>
                            <h1 class="heading">Result Comparison
                            </h1>
                            <div class="blog-para mt-3">
                                As you have seen, we used the exact same hardware, exact same dataset, exact same
                                queries. We took the lowest of the 5 runs for each query type for both of these
                                databases and compiled that result in this table:
                            </div>
                            <div class="my-4 table-div">
                                <table class="ShapeDataTable benchmark-table">
                                    <thead>
                                        <tr>
                                            <th>Query Type</th>
                                            <th>Elasticsearch</th>
                                            <th>SigLens</th>
                                            <th>Comparison</th>
                                        </tr>
                                    </thead>
                                    <tr>
                                        <td>Query 1</td>
                                        <td>27,559 ms</td>
                                        <td>55 ms</td>
                                        <td>SigLens is <b>501x</b> faster than Elasticsearch</td>
                                    </tr>
                                    <tr>
                                        <td>Query 2</td>
                                        <td>44,075 ms</td>
                                        <td>43 ms</td>
                                        <td>SigLens is <b>1025x</b> faster than Elasticsearch</td>
                                    </tr>
                                    <tr>
                                        <td>Query 3</td>
                                        <td>50,110 ms</td>
                                        <td>368 ms</td>
                                        <td>SigLens is <b>136x</b> faster than Elasticsearch</td>
                                    </tr>
                                    <tr>
                                        <td>Query 4</td>
                                        <td>1,25,167 ms</td>
                                        <td>9509 ms</td>
                                        <td>SigLens is <b>13x</b> faster than Elasticsearch</td>
                                    </tr>
                                </table>
                            </div>
                            <div class="blog-para">
                                SigLens proves to be <b>13x-1025x</b> faster on all 4 query types. These speed
                                advantages
                                of
                                SigLens are due to its dynamic columnar compressions, dynamic columnar
                                microindexing,
                                AgileAggsTree. These innovative techniques help run your filter and aggregation
                                queries
                                on complex datasets at lightning fast speeds.
                            </div>
                        </div>
                    </div>
                    <div id="section7" class="section mt-4">
                        <div>
                            <h1 class="heading">Try SigLens in less than 1 minute
                            </h1>
                            <div class="blog-para mt-3">
                                SigLens gets installed in less than a minute with docker or helm chart. Give it a try
                                and experience the difference.
                            </div>
                            <div class="d-flex flex-column flex-md-row align-items-center">
                                <div id="try-siglens-btn" onclick="redirectToPage('https://www.siglens.com/?&utm_source=web&utm_medium=social&utm_campaign=sigvsch#getting-started')">Try SigLens</div>
                                <div id="github-siglens-btn" class="ml-md-5" onclick="redirectToPage('https://github.com/siglens/siglens')"><i class="fa-brands fa-github" style="color: #fff; margin-right: 10px;"></i>GitHub Repo</div>
                            </div>
                        </div>
                    </div>
                    <div id="section8" class="section mt-4">
                        <div>
                            <h1 class="heading">Benchmark Questions?
                            </h1>
                            <div class="blog-para mt-3">
                                Both of these databases
                                were
                                given the exact same treatment, there was no unfair advantage given to SigLens.
                            </div>
                            <div class="blog-para mt-2">
                                You can verify these
                                test
                                results yourself by following the detailed steps we have outlined above. If you feel
                                something is incorrect please submit an issue or a pull request at <a
                                    href="https://github.com/siglens/siglens?utm_source=web&utm_medium=social&utm_campaign=sigvses">https://github.com/siglens/siglens</a>.
                            </div>
                            <p class="mt-2 courier-font note blog-para"><b>*  </b>Query 1 is a little different than Query 1 for SigLens.
                                This is because Elasticsearch was unable to perform an aggregation on the `airport_fee` column because it was ingested as a text field. So instead, this Query 1 aggregates on the `improvement_surcharge` field.
                                This should be comparable because the `airport_fee` column only has one bucket, while the `improvement_surcharge` column has only 2, and one of those only accounts for 360 rows of the more than 1 billion rows in the dataset.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <footer id="footer" class="pb-5">
        <div class="container">
            <div class="row py-0 py-md-5">
                <div class="col-md-7 d-flex flex-row pl-5 footer-links order-1 order-md-0 mt-5 mt-md-0">
                    <div>
                        <a href="https://siglens.github.io/siglens-docs/" target="_blank"
                            class="footer-nav-heading">Documentation</a>
                    </div>
                    <div>
                        <a href="/blog/allblogs.html" class="footer-nav-heading">Blogs</a>
                    </div>
                    <div class="d-flex flex-column">
                        <a href="#" class="footer-nav-heading">Community</a>
                        <a class="mt-3 pl-2" href="https://github.com/siglens/siglens">GitHub</a>
                        <a class="mt-3 pl-2" href="/slack.html">Slack</a>
                        <a class="mt-3 pl-2" href="../guides.html">Guides</a>
                        <a class="mt-3 pl-2" href="../questions.html">Questions</a>
                    </div>
                </div>
                <div class="col-md-5 text-md-start footer-links order-0 order-md-1 mx-4 mx-md-0">
                    <h5 class="text-start font-weight-bold text-white">Subscribe for updates</h5>
                    <form class="d-flex gap-4 align-items-end flex-row " id="newsletter-form">
                        <div class="flex-fill w-100 mt-4">
                            <input class="form-control" type="email" id="ns-email" placeholder="Your Email">
                        </div>
                        <div class="flex-grow w-auto">
                            <button class="btn btn-primary ml-2" id="ns-form-btn">Submit</button>
                        </div>
                    </form>
                </div>
                <div class="col-md-4 col-sm-12 mt-5 pl-5 order-2 order-md-2">
                    <div class="d-flex">
                        <a class="mr-4" href="https://twitter.com/sigscalr" target="_blank">
                            <div class="icon-container"><i class="fa-brands fa-x-twitter"></i></div>
                        </a>
                        <a class="" href="https://www.linkedin.com/company/sigscalr-io/" target="_blank">
                            <div class="icon-container"><i class="fa-brands fa-linkedin-in"></i></div>
                        </a>
                    </div>
                </div>
            </div>

            <div class="d-flex justify-content-center credits flex-column align-items-center mt-5 mt-md-0">
                <img src="../assets/ss-logo.svg" alt="" style="height: 50px;">
                <div class="font-weight-bold text-white h1 mb-4 mt-2">SigLens</div>
                <div class="text-center">Made with ❤️ in New Hampshire, California, Montana and India.</div>
                <div>Copyright © 2024 - <strong class="text-white pointer-event"><a
                            href="https://www.sigscalr.io/">SigScalr Inc.</a></strong></div>
            </div>
        </div>
    </footer>

    <!-- Include Prism.js library -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs/prism.js"></script>
    <!-- Include Prism.js language support for JSON -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs/components/prism-json.js"></script>
    <script>
        // Initialize Prism.js
        Prism.highlightAll();
    </script>


    <!-- jQuery and JS bundle w/ Popper.js -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
        integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx"
        crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
    <script src="/js/main.js"></script>
    <script src="./blog.js"></script>
</body>

</html>